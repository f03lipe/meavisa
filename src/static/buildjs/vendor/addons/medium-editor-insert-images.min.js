!function(e){e.fn.mediumInsert.registerAddon("images",{init:function(t){t&&t.$el&&(this.$el=t.$el),this.options=e.extend(this.default,t),this.setImageEvents(),this.setDragAndDropEvents(),this.preparePreviousImages()},insertButton:function(e){var t="Img";return"fontawesome"==e&&(t='<i class="fa fa-picture-o"></i>'),'<button data-addon="images" data-action="add" class="medium-editor-action medium-editor-action-image mediumInsert-action">'+t+"</button>"},"default":{imagesUploadScript:"upload.php",formatData:function(e){var t=new FormData;return t.append("file",e),t}},preparePreviousImages:function(){this.$el.find(".mediumInsert-images").each(function(){var t=e(this).parent();t.html('<div class="mediumInsert-placeholder" draggable="true">'+t.html()+"</div>")})},add:function(t){var n,i,s=this;return n=e('<input type="file">').click(),n.change(function(){i=this.files,s.uploadFiles(t,i,s)}),e.fn.mediumInsert.insert.deselect(),n},updateProgressBar:function(t){var n,i=e(".progress:first",this.$el);t.lengthComputable&&(n=t.loaded/t.total*100|0,i.attr("value",n),i.html(n))},uploadCompleted:function(t,n){var i,s=e(".progress:first",n);s.attr("value",100),s.html(100),s.before('<div class="mediumInsert-images"><img src="'+t.responseText+'" draggable="true" alt=""></div>'),i=s.siblings("img"),s.remove(),i.load(function(){i.parent().mouseleave().mouseenter()}),e.fn.mediumInsert.insert.$el.keyup()},uploadFile:function(t,n,i){e.ajax({type:"post",url:i.options.imagesUploadScript,xhr:function(){var e=new XMLHttpRequest;return e.upload.onprogress=i.updateProgressBar,e},cache:!1,contentType:!1,complete:function(e){i.uploadCompleted(e,t)},processData:!1,data:i.options.formatData(n)})},uploadFiles:function(e,t,n){for(var i={"image/png":!0,"image/jpeg":!0,"image/gif":!0},s=0;s<t.length;s++){var a=t[s];i[a.type]===!0&&(e.append('<progress class="progress" min="0" max="100" value="0">0</progress>'),n.uploadFile(e,a,n))}},setImageEvents:function(){this.$el.on("mouseenter",".mediumInsert-images",function(){var t,n,i=e("img",this);e.fn.mediumInsert.settings.enabled!==!1&&i.length>0&&(e(this).append('<a class="mediumInsert-imageRemove"></a>'),e(this).append(e(this).parent().parent().hasClass("small")?'<a class="mediumInsert-imageResizeBigger"></a>':'<a class="mediumInsert-imageResizeSmaller"></a>'),t=i.position().top+parseInt(i.css("margin-top"),10),n=i.position().left+i.width()-30,e(".mediumInsert-imageRemove",this).css({right:"auto",top:t,left:n}),e(".mediumInsert-imageResizeBigger, .mediumInsert-imageResizeSmaller",this).css({right:"auto",top:t,left:n-31}))}),this.$el.on("mouseleave",".mediumInsert-images",function(){e(".mediumInsert-imageRemove, .mediumInsert-imageResizeSmaller, .mediumInsert-imageResizeBigger",this).remove()}),this.$el.on("click",".mediumInsert-imageResizeSmaller",function(){e(this).parent().parent().parent().addClass("small"),e(this).parent().mouseleave().mouseleave(),e.fn.mediumInsert.insert.deselect()}),this.$el.on("click",".mediumInsert-imageResizeBigger",function(){e(this).parent().parent().parent().removeClass("small"),e(this).parent().mouseleave().mouseleave(),e.fn.mediumInsert.insert.deselect()}),this.$el.on("click",".mediumInsert-imageRemove",function(){0===e(this).parent().siblings().length&&e(this).parent().parent().parent().removeClass("small"),e(this).parent().remove(),e.fn.mediumInsert.insert.deselect()})},setDragAndDropEvents:function(){var t,n,i=this,s=!1,a=!1;e(document).on("dragover","body",function(){e.fn.mediumInsert.settings.enabled!==!1&&e(this).addClass("hover")}),e(document).on("dragend","body",function(){e.fn.mediumInsert.settings.enabled!==!1&&e(this).removeClass("hover")}),this.$el.on("dragover",".mediumInsert",function(){e.fn.mediumInsert.settings.enabled!==!1&&(e(this).addClass("hover"),e(this).attr("contenteditable",!0))}),this.$el.on("dragleave",".mediumInsert",function(){e.fn.mediumInsert.settings.enabled!==!1&&(e(this).removeClass("hover"),e(this).attr("contenteditable",!1))}),this.$el.on("dragstart",".mediumInsert .mediumInsert-images img",function(){e.fn.mediumInsert.settings.enabled!==!1&&(t=e(this).parent().index(),n=e(this).parent().parent().parent().attr("id"))}),this.$el.on("dragend",".mediumInsert .mediumInsert-images img",function(t){e.fn.mediumInsert.settings.enabled!==!1&&s===!0&&(0===e(t.originalEvent.target.parentNode).siblings().length&&e(t.originalEvent.target.parentNode).parent().parent().removeClass("small"),e(t.originalEvent.target.parentNode).mouseleave(),e(t.originalEvent.target.parentNode).remove(),s=!1,a=!1)}),this.$el.on("dragover",".mediumInsert .mediumInsert-images img",function(t){e.fn.mediumInsert.settings.enabled!==!1&&t.preventDefault()}),this.$el.on("drop",".mediumInsert .mediumInsert-images img",function(){var i,s,r;if(e.fn.mediumInsert.settings.enabled!==!1){if(n!==e(this).parent().parent().parent().attr("id"))return a=!1,void(t=n=null);i=parseInt(t,10),s=e(this).parent().parent().find(".mediumInsert-images:nth-child("+(i+1)+")"),r=e(this).parent().index(),r>i?s.insertAfter(e(this).parent()):i>r&&s.insertBefore(e(this).parent()),s.mouseleave(),a=!0,t=null}}),this.$el.on("drop",".mediumInsert",function(t){var n;t.preventDefault(),e.fn.mediumInsert.settings.enabled!==!1&&(e(this).removeClass("hover"),e("body").removeClass("hover"),e(this).attr("contenteditable",!1),n=t.originalEvent.dataTransfer.files,n.length>0?i.uploadFiles(e(".mediumInsert-placeholder",this),n,i):a===!0?a=!1:(e(".mediumInsert-placeholder",this).append('<div class="mediumInsert-images">'+t.originalEvent.dataTransfer.getData("text/html")+"</div>"),e("meta",this).remove(),s=!0))})}})}(jQuery);
//# sourceMappingURL=medium-editor-insert-images.min.js.map