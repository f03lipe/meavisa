!function(e){var t={};MediumEditor.prototype.serialize=function(){var t,n,i,s,r,m,d,o,a={};for(t=0;t<this.elements.length;t+=1){for(i=""!==this.elements[t].id?this.elements[t].id:"element-"+t,s=e(this.elements[t]).clone(),r=e(".mediumInsert",s),n=0;n<r.length;n++)m=e(r[n]),d=e(".mediumInsert-placeholder",m).children(),0===d.length?m.remove():(m.removeAttr("contenteditable"),e("img[draggable]",m).removeAttr("draggable"),m.hasClass("small")&&d.addClass("small"),e(".mediumInsert-buttons",m).remove(),d.unwrap());o=s.html().trim(),a[i]={value:o}}return a},MediumEditor.prototype.deactivate=function(){var t;if(!this.isActive)return!1;for(this.isActive=!1,void 0!==this.toolbar&&(this.toolbar.style.display="none"),document.documentElement.removeEventListener("mouseup",this.checkSelectionWrapper),t=0;t<this.elements.length;t+=1)this.elements[t].removeEventListener("keyup",this.checkSelectionWrapper),this.elements[t].removeEventListener("blur",this.checkSelectionWrapper),this.elements[t].removeAttribute("contentEditable");e.fn.mediumInsert.insert.$el.mediumInsert("disable")},MediumEditor.prototype.activate=function(){var t;if(this.isActive)return!1;for(void 0!==this.toolbar&&(this.toolbar.style.display="block"),this.isActive=!0,t=0;t<this.elements.length;t+=1)this.elements[t].setAttribute("contentEditable",!0);this.bindSelect(),e.fn.mediumInsert.insert.$el.mediumInsert("enable")},e.fn.mediumInsert=function(n){return"string"==typeof n&&e.fn.mediumInsert.insert[n]?void e.fn.mediumInsert.insert[n]():(e.fn.mediumInsert.settings=e.extend(e.fn.mediumInsert.settings,n),this.each(function(){e("p",this).bind("dragover drop",function(e){return e.preventDefault(),!1}),e.fn.mediumInsert.insert.init(e(this));for(var n in e.fn.mediumInsert.settings.addons){var i=e.fn.mediumInsert.settings.addons[n];i.$el=e.fn.mediumInsert.insert.$el,t[n].init(i)}}))},e.fn.mediumInsert.settings={enabled:!0,addons:{images:{}}},e.fn.mediumInsert.registerAddon=function(e,n){t[e]=n},e.fn.mediumInsert.getAddon=function(e){return t[e]},e.fn.mediumInsert.insert={init:function(e){this.$el=e,this.isFirefox=navigator.userAgent.match(/firefox/i),this.setPlaceholders(),this.setEvents()},deselect:function(){document.getSelection().removeAllRanges()},disable:function(){e.fn.mediumInsert.settings.enabled=!1,e.fn.mediumInsert.insert.$el.find(".mediumInsert-buttons").addClass("hide")},enable:function(){e.fn.mediumInsert.settings.enabled=!0,e.fn.mediumInsert.insert.$el.find(".mediumInsert-buttons").removeClass("hide")},getMaxId:function(){var t=-1;return e('div[id^="mediumInsert-"]').each(function(){var n=parseInt(e(this).attr("id").split("-")[1],10);n>t&&(t=n)}),t},setPlaceholders:function(){var n=this,i=e.fn.mediumInsert.insert.$el,s=e.fn.mediumInsert.settings.editor,r=s&&s.options?s.options.buttonLabels:"",m='<ul class="mediumInsert-buttonsOptions medium-editor-toolbar medium-editor-toolbar-active">';if(0===Object.keys(e.fn.mediumInsert.settings.addons).length)return!1;for(var d in e.fn.mediumInsert.settings.addons)m+="<li>"+t[d].insertButton(r)+"</li>";m+="</ul>",m='<div class="mediumInsert" contenteditable="false"><div class="mediumInsert-buttons"><a class="mediumInsert-buttonsShow">+</a>'+m+'</div><div class="mediumInsert-placeholder"></div></div>',i.is(":empty")&&i.html("<p><br></p>"),i.keyup(function(){var t,s=i.children(":last");(""===i.html()||"<br>"===i.html())&&i.html("<p><br></p>"),s.hasClass("mediumInsert")&&s.find(".mediumInsert-placeholder").children().length>0&&i.append("<p><br></p>"),this.isFirefox&&e(".mediumInsert .mediumInsert-placeholder:empty",i).each(function(){e(this).parent().remove()}),t=n.getMaxId()+1,i.children("p").each(function(){e(this).next().hasClass("mediumInsert")===!1&&(e(this).after(m),e(this).next(".mediumInsert").attr("id","mediumInsert-"+t)),t++})}).keyup()},setEvents:function(){var n=this,i=e.fn.mediumInsert.insert.$el;i.on("selectstart",".mediumInsert",function(e){return e.preventDefault(),!1}),i.on("blur",function(){var t,n=e(this).clone();n.find(".mediumInsert").remove(),t=n.html().replace(/^\s+|\s+$/g,""),(""===t||"<p><br></p>"===t)&&e(this).addClass("medium-editor-placeholder")}),i.on("keypress",function(e){if(n.isFirefox&&13===e.keyCode){i.contents().each(function(){return function(e,t){return"#text"===t.nodeName?(document.execCommand("insertHTML",!1,"<p>"+t.data+"</p>"),t.remove()):void 0}}(this));var t=i.find("p").last();t.text().length>0&&t.find("br").remove()}}),i.on("keydown",function(e){return navigator.userAgent.match(/chrome/i)&&(i.children().last().removeClass("hide"),(e.ctrlKey||e.metaKey)&&65===e.which)?(e.preventDefault(),0===i.find("p").text().trim().length?!1:(i.children().last().addClass("hide"),document.execCommand("selectAll",!1,null))):void 0}),i.on("click",".mediumInsert-buttons a.mediumInsert-buttonsShow",function(){var t=e(this).siblings(".mediumInsert-buttonsOptions"),i=e(this).parent().siblings(".mediumInsert-placeholder");e(this).hasClass("active")?(e(this).removeClass("active"),t.hide(),e("a",t).show()):(e(this).addClass("active"),t.show(),e("a",t).each(function(){var n=e(this).attr("class").split("action-")[1],s=n.split("-")[0];e(".mediumInsert-"+s,i).length>0&&e("a:not(.action-"+n+")",t).hide()})),n.deselect()}),i.on("mouseleave",".mediumInsert",function(){e("a.mediumInsert-buttonsShow",this).removeClass("active"),e(".mediumInsert-buttonsOptions",this).hide()}),i.on("click",".mediumInsert-buttons .mediumInsert-action",function(){var n=e(this).data("addon"),i=e(this).data("action"),s=e(this).parents(".mediumInsert-buttons").siblings(".mediumInsert-placeholder");t[n]&&t[n][i]&&t[n][i](s),e(this).parents(".mediumInsert").mouseleave()})}}}(jQuery);
//# sourceMappingURL=medium-editor-insert-plugin.min.js.map